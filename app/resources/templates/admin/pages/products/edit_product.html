{% extends 'admin/pages/products/new_products.html' %}
{% block title %}Edit Product - {{ product.name }}{% endblock %}

{% block form_title %}Edit Product{% endblock %}
{% block form_action %}{{ url_for('web.web_admin.products.edit_product', identifier=product.id) }}{% endblock %}

{% block form_content %}
    {{ super() }}
    
    <!-- Pass existing variants to JavaScript -->
    {% if existing_variants %}
    <input type="hidden" id="existing-variants-json" value="{{ existing_variants|tojson|forceescape }}">
    {% endif %}
{% endblock %}

{% block extra_js %}
<script>
    // Load existing variants when editing
    document.addEventListener('DOMContentLoaded', function() {
        const existingVariantsInput = document.getElementById('existing-variants-json');
        if (existingVariantsInput && existingVariantsInput.value) {
            try {
                const variants = JSON.parse(existingVariantsInput.value);
                if (variants && variants.length > 0) {
                    // Populate variants display
                    window.loadExistingVariants(variants);
                }
            } catch (e) {
                console.error('Failed to load existing variants', e);
            }
        }
    });
</script>
{% endblock %}